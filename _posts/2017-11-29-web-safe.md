---
layout: post
title: Web安全讲座笔记 17.11.29
excerpt: 前端数据不可信，常见安全风险与解决方法
category: frontend
---

#### 前端数据不可信
一、SQL注入

http协议的所有参数，后台使用都可能SQL注入

解决方法：框架也是预编译，用#开头，不用$开头

二、脚本xss

跨站漏洞，css背景链接，第三方不安全库jQuery1.1.1

eg：偷cookie；微博跨站蠕虫（点链接就加载第三方js自动发微博）

解决方法：特殊字符转译，禁止加载第三方资源，浏览器自带过滤攻击脚本（cookie: HttpOnly //不许js读取cookie），ESAPI

三、越权问题

对不属于自己的资源增删查该

eg：表单提交时加越权字段给数据库；删除地址--用户id与地址id未绑定；修改用户密码；id有规律可便利；未授权访问

四、程序信息泄露

直接报错，带sql列名表名；

解决方法：应用层加密：对称／非对称加密（用rsa非对称加密aes密钥，data用aes对称加密，后台用公钥解密出aes密钥，在解密data）；传输层加密：https（未到应用层仍然可以劫持）

五、敏感信息脱敏

身份证保留前6后1；银行卡号保留前4后4；手机保留前3后4；姓名只保留姓氏；固话中间3为掩码；邮箱第5个字符到@之间掩码

六、撞库：登录、注册、找回 --- 机器行为

解决方法：（限制自动化）
登录参数解密（密码，用户名都要加密，防止123456这种密码）；
更换设备要、首次登录验证码；
限制失败次数；
成果失败都返回200；
设备指纹。

七、上传下载

上传--角色、大小、类型、重命名hash、存储位置（与应用服务器分开、只读写权限）

下载--权限（用../跳出当前目录）

#### 软件安全开发
案例：

58同城信息泄漏：接口A可查简历信息、接口B可查用户真实姓名、接口C可查用户电话 --- 设计不合理

#### 安全开发中心
6个阶段：需求分析、设计阶段、开发阶段、测试阶段、发布阶段、维护阶段

[STRIDE模型](http://blog.csdn.net/tengzhaorong/article/details/6782974)

#### 风险处置手段
删减功能（危害高，不重要），重新设计（有风险、重要），防御措施（多项连续校验防止绕过），酌情处理

最小权限原则、权限分离、不信任（前端不信任）、攻击面最小化（少开放接口）、保护最薄弱环节、纵深防御（密码加密后后续流程继续防护）、公开设计（算法公开密钥保护）、隐私保护、安全设计、安全开发、安全维护